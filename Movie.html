<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CineLux</title>

<link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;800&display=swap" rel="stylesheet">
<script src="https://accounts.google.com/gsi/client" async defer></script>

<style>
:root {
    --gold:#D4AF37;
    --bg:#050505;
    --glass:rgba(255,255,255,.05);
    --border:rgba(255,255,255,.12);
}
*{margin:0;padding:0;box-sizing:border-box;font-family:'Plus Jakarta Sans',sans-serif;}
body{background:var(--bg);color:#fff}

/* Container for the buttons */
.movie-overlay {
    position: absolute;
    inset: 0;
    background: rgba(0, 0, 0, 0.7);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 10px;
    opacity: 0; /* Hidden by default */
    transition: 0.3s ease;
    z-index: 2;
}
small {
    font-size: 12px;
    display: block;
    margin-top: 2px;
}
.info-group p {
    font-size: 16px;
    margin-top: 5px;
}


/* Show overlay on hover */
.movie-card:hover .movie-overlay {
    opacity: 1;
}

/* Button Styles */
.opt-btn {
    width: 80%;
    padding: 10px;
    border: none;
    border-radius: 5px;
    font-weight: 800;
    cursor: pointer;
    transition: 0.2s;
}

.play-btn {
    background: var(--gold);
    color: black;
}

.watch-btn {
    background: rgba(255, 255, 255, 0.2);
    color: white;
    backdrop-filter: blur(5px);
    border: 1px solid rgba(255, 255, 255, 0.3);
}

.opt-btn:hover {
    transform: scale(1.05);
}

/* AUTH */
#authOverlay{
    position:fixed;inset:0;
    background:#050505;
    display:flex;align-items:center;justify-content:center;
    z-index:9999;text-align:center;
}
/* --- NAVIGATION --- */
        nav {
            display: grid; grid-template-columns: 1fr 2fr 1fr; align-items: center;
            padding: 0 5%; height: 90px; position: fixed; width: 100%; z-index: 2000;
            background: linear-gradient(to bottom, rgba(5,5,5,0.9), transparent); backdrop-filter: blur(15px);
        }
        .search-box { background: var(--glass); border: 1px solid var(--border); padding: 10px 20px; border-radius: 100px; display: flex; align-items: center; }
        .search-box input { background: transparent; border: none; color: white; outline: none; width: 100%; margin-left: 10px; }

        /* --- HERO BANNER --- */
        .hero {
            height: 80vh; padding: 0 8%; display: flex; align-items: center;
            background: linear-gradient(to right, #050505 30%, transparent), url('https://images.unsplash.com/photo-1626814026160-2237a95fc5a0?w=1600') center/cover;
        }

        /* --- SIDEBAR --- */
        .sidebar { position: fixed; left: -400px; top: 0; width: 320px; height: 100vh; background: #000; z-index: 4000; padding: 60px 40px; transition: 0.5s; border-right: 1px solid var(--border); }
        .sidebar.open { left: 0; }
        .side-link { display: block; font-size: 18px; padding: 10px 0; color: #ccc; cursor: pointer; transition: 0.3s; }
        .side-link:hover { color: var(--gold); transform: translateX(5px); }

        /* --- CONTENT --- */
        .container { padding: 40px 8%; }
        .panel { display: none; animation: fadeIn 0.4s ease; }
        .active-panel { display: block; }
        .movie-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 20px; }
        .movie-card { border-radius: 15px; overflow: hidden; height: 320px; cursor: pointer; border: 1px solid var(--border); position: relative; transition: 0.4s; }
        .movie-card:hover { transform: scale(1.05); border-color: var(--gold); }
        .movie-card img { width: 100%; height: 100%; object-fit: cover; }

        /* --- INPUTS --- */
        .card { background: #111; padding: 30px; border-radius: 20px; border: 1px solid var(--border); }
        .input-f { width: 100%; padding: 15px; background: #000; border: 1px solid #333; color: white; border-radius: 10px; margin-bottom: 15px; }
        .btn-gold { background: var(--gold); border: none; width: 100%; padding: 15px; border-radius: 10px; font-weight: 800; cursor: pointer; }

.movie-info {
    position: absolute;
    bottom: 0;
    width: 100%;
    background: linear-gradient(transparent, rgba(0,0,0,0.9));
    padding: 20px 15px !important;
}


        /* --- VIDEO PLAYER --- */
        #theater { position: fixed; inset: 0; background: #000; z-index: 9000; display: none; flex-direction: column; }
        video { width: 100%; height: 90vh; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
</style>
</head>

<body>

<!-- AUTH -->
<div id="authOverlay">
    <div>
        <h1 style="font-size:3.5rem">
            CINE<span style="color:var(--gold)">LUX</span>
        </h1>

        <!-- GOOGLE LOGIN -->
        <div id="g_id_onload"
             data-client_id="739537461326-r2gspogeoruch5a4b2m6kui2v9e1lchp.apps.googleusercontent.com"
             data-callback="onGoogleLogin"
             data-auto_prompt="false">
        </div>

        <div class="g_id_signin"
             data-type="standard"
             data-size="large"
             data-theme="outline"
             data-shape="pill"
             data-text="continue_with">
        </div>
    </div>
</div>

<!-- VIDEO PLAYER -->

    <div id="theater">
        <div style="padding: 15px 5%; display: flex; justify-content: space-between;">
            <h2 id="mTitle">Now Playing</h2>
            <button onclick="closeTheater()" style="color:var(--gold); background:none; border:none; cursor:pointer; font-weight:800;">CLOSE ✕</button>
        </div>
        <video id="vid" controls autoplay><source src="https://www.w3schools.com/html/mov_bbb.mp4" type="video/mp4"></video>
    </div>

    <nav>
        <div onclick="toggleMenu()" style="color:var(--gold); cursor:pointer; font-weight:800;">☰ MENU</div>
        <div class="search-box">
            <input type="text" id="searchInput" placeholder="Search Movies..." onkeyup="search()">
        </div>
        <div onclick="showPanel('account')" id="uIcon" style="width:35px; height:35px; border-radius:50%; background:var(--gold); color:black; display:flex; align-items:center; justify-content:center; font-weight:800; cursor:pointer; justify-self: end;">?</div>
    </nav>

    <div class="sidebar" id="sidebar">
        <div class="side-link" onclick="showAllMovies()">Discovery</div>

        <hr style="border:0; border-top:1px solid #222; margin:10px 0;">
        <div class="side-link" onclick="showWatchlist()">My Watchlist</div>

        <span style="font-size:10px; color:#444; letter-spacing:2px;">CATEGORIES</span>
        <div class="side-link" onclick="filter('Action')">Action</div>
        <div class="side-link" onclick="filter('Sci-Fi')">Sci-Fi</div>
        <div class="side-link" onclick="filter('Horror')">Horror</div>
        <div class="side-link" onclick="filter('Drama')">Drama</div>
        <div class="side-link" onclick="filter('Documentary')">Documentary</div>
        <hr style="border:0; border-top:1px solid #222; margin:10px 0;">
        <div class="side-link" onclick="showPanel('account')">Account Details</div>
        <div class="side-link" onclick="showPanel('settings')">Settings</div>
        <div class="side-link" onclick="showPanel('contact')">Contact Support</div>
        <div class="side-link" style="color:#ff4444" onclick="logout()">Logout</div>
    </div>

    <section class="hero" id="heroBanner">
        <div>
        <h1 onclick="showAllMovies()" style="cursor:pointer">
    CINE<span style="color:var(--gold)">LUX</span>
</h1>

            <p style="color:var(--gold); font-weight:800; letter-spacing:4px;">NEW RELEASE</p>
            <h1 style="font-size: 4.5rem; line-height:1; margin: 15px 0;">INTERSTELLAR</h1>
            <button class="btn-gold" style="width:auto; padding: 15px 40px;" onclick="openTheater('Interstellar')">STREAM NOW</button>
        </div>
    </section>
<div id="homePanel" class="panel active-panel">
    <h2 id="catTitle" style="margin-bottom:30px; font-weight:300; letter-spacing:2px;">DISCOVERY</h2>
    <div class="movie-grid" id="movieGrid"></div>
</div>

<div id="accountPanel" class="panel">
    <h1 style="margin-bottom: 20px;">Account Hub</h1>
    
    <div style="display: flex; gap: 10px; margin-bottom: 20px; overflow-x: auto; white-space: nowrap; padding-bottom: 10px;">
        <button class="btn-gold" style="width:auto; padding:8px 20px; font-size:12px;" onclick="showSubTab('acc-main')">Profile</button>
        <button class="btn-gold" style="width:auto; padding:8px 20px; font-size:12px; background:#222; color:#fff;" onclick="showSubTab('acc-history')">History</button>
        <button class="btn-gold" style="width:auto; padding:8px 20px; font-size:12px; background:#222; color:#fff;" onclick="showSubTab('acc-social')">Interactions</button>
    </div>

    <div id="acc-main" class="sub-panel">
        <div class="card">
            <div style="display: flex; align-items: center; gap: 20px; margin-bottom: 30px;">
                <div id="uAvatar" style="width: 80px; height: 80px; border-radius: 15px; background: var(--gold); display:flex; align-items:center; justify-content:center; overflow:hidden;">?</div>
                <div>
                    <h2 id="uNameDisplay" style="margin:0">User</h2>
                    <p id="uEmail" style="color: #666; font-size: 14px;"></p>
                </div>
            </div>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                <div class="info-group"><label style="font-size:10px; color:#666;">PLAN</label><p style="color:var(--gold)">Lifetime Pro</p></div>
                <div class="info-group"><label style="font-size:10px; color:#666;">STATUS</label><p>Active ✓</p></div>
            </div>
            <button class="btn-gold" style="margin-top:20px;" onclick="showPanel('feedback')">HELP & FEEDBACK</button>
        </div>
    </div>

    <div id="acc-history" class="sub-panel" style="display:none;">
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
            <h3>Watch History</h3>
            <button onclick="clearHistory()" style="background:none; border:none; color:#ff4444; cursor:pointer;">Clear All</button>
        </div>
        <div id="historyList" style="display: flex; flex-direction: column; gap: 10px;"></div>
    </div>

    <div id="acc-social" class="sub-panel" style="display:none;">
        <h3 style="margin-bottom:15px;">My Likes</h3>
        <div id="likesList" style="display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-bottom:30px;"></div>
        <h3 style="margin-bottom:15px;">My Comments</h3>
        <div id="commentsList" class="card" style="font-size:14px; color:#888;">No comments yet.</div>
    </div>
</div>

<div id="settingsPanel" class="panel">
    <h1>Settings</h1>
    <div class="card">
        <h3 style="color:var(--gold); margin-bottom:15px;">Languages</h3>
        <select class="input-f" id="appLang" onchange="saveSetting('lang', this.value)">
            <option value="en">English</option>
            <option value="hi">Hindi</option>
            <option value="es">Spanish</option>
        </select>

        <h3 style="color:var(--gold); margin:25px 0 15px;">App System</h3>
        <button class="input-f" style="text-align:left;" onclick="checkUpdates()">Check for Updates <span style="float:right">v2.4.0</span></button>
        
        <div style="margin-top:20px; display:flex; flex-direction:column; gap:12px;">
            <a href="#" class="side-link" onclick="alert('CineLux v2.4\nCreated for the best streaming experience.')">About Us</a>
            <a href="#" class="side-link" onclick="alert('Privacy Policy: Your data is stored locally.')">Privacy Policy</a>
            <a href="#" class="side-link" onclick="alert('Agreement: Use CineLux for personal entertainment.')">User Agreement</a>
        </div>

        <div id="settingsFooter" style="margin-top:40px; border-top:1px solid #222; padding-top:20px; text-align:center; color:#444; font-size:11px;"></div>
    </div>
</div>



        <div id="contactPanel" class="panel">
            <h1>Contact Support</h1>
            <div class="card">
                <input type="text" class="input-f" placeholder="Subject">
                <textarea class="input-f" placeholder="How can we help?" style="height:150px;"></textarea>
                <button class="btn-gold" onclick="alert('Support Message Sent!')">Send Message</button>
            </div>
        </div>
    </div>

    <script>
        const movies = [
            { title: "Inception", rating: "8.8", img: "https://images.unsplash.com/photo-1440404653325-ab127d49abc1?auto=format&fit=crop&w=400&q=80" },
            { title: "The Dark Knight", rating: "9.0", img: "https://images.unsplash.com/photo-1478720568477-152d9b164e26?auto=format&fit=crop&w=400&q=80" },
            { title: "Avatar: Way of Water", rating: "7.8", img: "https://images.unsplash.com/photo-1536440136628-849c177e76a1?auto=format&fit=crop&w=400&q=80" },
            { title: "The Matrix", rating: "8.7", img: "https://images.unsplash.com/photo-1626814026160-2237a95fc5a0?auto=format&fit=crop&w=400&q=80" },
            { title: "Joker", rating: "8.4", img: "https://images.unsplash.com/photo-1509248961158-e54f6934749c?auto=format&fit=crop&w=400&q=80" },
            { title: "The Martian", rating: "8.0", img: "https://images.unsplash.com/photo-1614728263952-84ea256f9679?auto=format&fit=crop&w=400&q=80" }
        ];

let myWatchlist = JSON.parse(localStorage.getItem('watchlist')) || [];


function onGoogleLogin(res){
    const payload = JSON.parse(atob(res.credential.split('.')[1]));
    localStorage.setItem('user',JSON.stringify(payload));
    location.reload();
}
function init() {
    const u = JSON.parse(localStorage.getItem('user'));
    
    if (!u) {
        document.getElementById('authOverlay').style.display = 'flex';
        return; 
    }

    document.getElementById('authOverlay').style.display = 'none';

    // UI Elements setup
    const userIcon = document.getElementById('uIcon');
    const uAvatar = document.getElementById('uAvatar');
    const uNameDisplay = document.getElementById('uNameDisplay');
    const uEmail = document.getElementById('uEmail');

    if(u.picture) {
        const imgHtml = `<img src="${u.picture}" style="width:100%; height:100%; border-radius:15px; object-fit:cover;">`;
        userIcon.innerHTML = imgHtml;
        if(uAvatar) uAvatar.innerHTML = imgHtml;
    } else {
        const initial = u.name ? u.name[0] : '?';
        userIcon.innerText = initial;
        if(uAvatar) uAvatar.innerText = initial;
    }
    
    if(uNameDisplay) uNameDisplay.innerText = u.name || "CineLux User";
    if(uEmail) uEmail.innerText = u.email;

    // Device Footer Update
    const footer = document.getElementById('settingsFooter');
    if(footer) {
        const platform = navigator.platform;
        footer.innerHTML = `Connected via: <b>${platform}</b> | Session: Active`;
    }

    render(movies);
}

function render(data) {
    const grid = document.getElementById('movieGrid');
    if (!grid) return;

    grid.innerHTML = data.map(m => {
        const isSaved = myWatchlist.includes(m.title);
        const isLiked = (JSON.parse(localStorage.getItem('likedMovies')) || []).includes(m.title);

        return `
            <div class="movie-card">
                <img src="${m.img}" alt="${m.title}">
                
                <div class="movie-overlay">
                    <button class="opt-btn play-btn" onclick="openTheater('${m.title}')">▶ PLAY</button>
                    <button class="opt-btn watch-btn" onclick="toggleWatchlist('${m.title}')">
                        ${isSaved ? '✓ SAVED' : '+ WATCHLIST'}
                    </button>
                    <button onclick="toggleLike('${m.title}')" style="background:none; border:none; color:${isLiked ? '#ff4444' : '#fff'}; cursor:pointer; font-size:1.5rem; margin-top:10px;">
                        ${isLiked ? '❤' : '♡'}
                    </button>
                </div>

                <div class="movie-info">
                    <h3 style="font-size: 1rem; margin: 0;">${m.title}</h3>
                    <div style="display:flex; justify-content:space-between; align-items:center;">
                        <span style="color: var(--gold); font-size: 0.8rem;">★ ${m.rating || '8.5'}</span>
                        <span style="font-size:0.7rem; opacity:0.6;">${m.cat || 'Movie'}</span>
                    </div>
                </div>
            </div>
        `;
    }).join('');
}
// --- LIKE LOGIC ---
function toggleLike(title) {
    let likes = JSON.parse(localStorage.getItem('likedMovies')) || [];
    const index = likes.indexOf(title);
    if(index === -1) likes.push(title);
    else likes.splice(index, 1);
    localStorage.setItem('likedMovies', JSON.stringify(likes));
    render(movies); // UI Refresh
}

// --- HISTORY LOGIC ---
function addToHistory(title) {
    let history = JSON.parse(localStorage.getItem('watchHistory')) || [];
    history = history.filter(t => t !== title); // Duplicate remove
    history.unshift(title); // Latest watch top par
    localStorage.setItem('watchHistory', JSON.stringify(history.slice(0, 10)));
}

// --- OPEN THEATER (Updated to track history) ---
function openTheater(title) {
    document.getElementById('mTitle').innerText = title;
    document.getElementById('theater').style.display = 'flex';
    addToHistory(title); // History record
}

// --- FEEDBACK & LOGS ---
function sendFeedback() {
    const msg = document.getElementById('feedMsg').value;
    if(msg) {
        alert("CineLux Team: Thanks for your feedback!");
        document.getElementById('feedMsg').value = "";
        showPanel('home');
    }
}

function checkUpdates() {
    alert("CineLux v2.4.0\nStatus: Up to Date\nRecent Logs: Added Watch History, User Interaction, and Device Detection.");
}

// --- SUB-TAB SWITCHER (For My List, History, etc.) ---
function showSubTab(id) {
    document.querySelectorAll('.sub-panel').forEach(p => p.style.display = 'none');
    const target = document.getElementById(id);
    if(target) target.style.display = 'block';
    
    // Agar history tab hai to render karein
    if(id === 'acc-history') {
        const historyList = document.getElementById('historyList');
        const data = JSON.parse(localStorage.getItem('watchHistory')) || [];
        historyList.innerHTML = data.map(t => `<div class="card" style="margin-bottom:10px; padding:10px;">${t}</div>`).join('') || "No history.";
    }
}



//OF SETTING
// --- DATA STORAGE ---
let watchHistory = JSON.parse(localStorage.getItem('watchHistory')) || [];
let likedMovies = JSON.parse(localStorage.getItem('likedMovies')) || [];

// --- TAB SYSTEM ---
function showSubTab(tabId) {
    // Hide all sub-panels
    document.querySelectorAll('.sub-panel').forEach(p => p.style.display = 'none');
    // Show selected sub-panel
    document.getElementById(tabId).style.display = 'block';
    
    // Refresh content
    if(tabId === 'acc-history') renderHistory();
    if(tabId === 'acc-social') renderLikes();
}

// --- WATCH HISTORY LOGIC ---
function addToHistory(title) {
    // Remove if already exists to bring to top
    watchHistory = watchHistory.filter(item => item !== title);
    watchHistory.unshift(title); // Add to beginning
    if(watchHistory.length > 20) watchHistory.pop(); // Limit to 20
    localStorage.setItem('watchHistory', JSON.stringify(watchHistory));
}

function renderHistory() {
    const container = document.getElementById('historyList');
    if(watchHistory.length === 0) {
        container.innerHTML = "<p style='color:#666'>No movies watched yet.</p>";
        return;
    }
    container.innerHTML = watchHistory.map(title => `
        <div class="card" style="padding:10px 20px; display:flex; justify-content:space-between; align-items:center; background:var(--glass);">
            <span>${title}</span>
            <button class="btn-gold" style="width:auto; padding:5px 15px; font-size:10px;" onclick="openTheater('${title}')">REWATCH</button>
        </div>
    `).join('');
}

function clearHistory() {
    if(confirm("Clear all watch history?")) {
        watchHistory = [];
        localStorage.removeItem('watchHistory');
        renderHistory();
    }
}

// --- LIKES LOGIC ---
function toggleLike(title) {
    const index = likedMovies.indexOf(title);
    if(index === -1) likedMovies.push(title);
    else likedMovies.splice(index, 1);
    localStorage.setItem('likedMovies', JSON.stringify(likedMovies));
    render(movies); // Refresh main grid heart icons
}

function renderLikes() {
    const container = document.getElementById('likesList');
    if(likedMovies.length === 0) {
        container.innerHTML = "<p style='color:#666'>No liked movies yet.</p>";
        return;
    }
    container.innerHTML = likedMovies.map(title => `
        <div class="card" style="padding:10px; text-align:center; border-color:var(--gold);">
            <p style="font-size:12px;">${title}</p>
        </div>
    `).join('');
}

// --- SYSTEM & DEVICE LOGIC ---
function checkUpdates() {
    const btn = event.target;
    btn.innerText = "Checking...";
    setTimeout(() => {
        btn.innerText = "Version 2.4.0 (Up to date) ✓";
        alert("Logs:\n- Integrated History tracking\n- Fixed Account Tab switching\n- Added Local Device detection");
    }, 1500);
}

function updateDeviceInfo() {
    const footer = document.getElementById('settingsFooter');
    if(!footer) return;
    const platform = navigator.platform;
    const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
    footer.innerHTML = `DEVICE: <b>${platform} ${isMobile ? 'Mobile' : 'PC'}</b><br>
                        BROWSER: <b>${navigator.vendor || 'Generic'}</b><br>
                        ENGINE: <b>V8 Build 2.4</b>`;
}

// --- UPDATE EXISTING OPEN THEATER ---
// Modify your existing openTheater to record history
const originalOpenTheater = openTheater; 
openTheater = function(title) {
    addToHistory(title); // Record history
    originalOpenTheater(title); // Call existing play logic
};

// --- INITIALIZE ON LOAD ---
updateDeviceInfo();

//CLOSE

function search() {
    const q = document.getElementById('searchInput').value.toLowerCase();
    render(movies.filter(m => m.title.toLowerCase().includes(q)));
}

function filter(c) {
    // We need to ensure catTitle exists or just use an alert/header
    const titleEl = document.getElementById('catTitle');
    if(titleEl) titleEl.innerText = c.toUpperCase();
    
    render(movies.filter(m => m.cat === c));
    showPanel('home');
}

function showWatchlist() {
    const savedMovies = movies.filter(m => myWatchlist.includes(m.title));
    const titleEl = document.getElementById('catTitle');
    if(titleEl) titleEl.innerText = "MY WATCHLIST";
    
    showPanel('home');
    
    if (savedMovies.length === 0) {
        document.getElementById('movieGrid').innerHTML = `
            <div style="grid-column: 1/-1; text-align: center; padding: 50px; color: #666;">
                <h3>Your watchlist is empty</h3>
                <p>Click + WATCHLIST on any movie to save it here.</p>
            </div>`;
    } else {
        render(savedMovies);
    }
}

function toggleWatchlist(title) {
    const index = myWatchlist.indexOf(title);
    if (index === -1) {
        myWatchlist.push(title);
    } else {
        myWatchlist.splice(index, 1);
    }
    localStorage.setItem('watchlist', JSON.stringify(myWatchlist));

    const titleEl = document.getElementById('catTitle');
    if (titleEl && titleEl.innerText === "MY WATCHLIST") {
        showWatchlist();
    } else {
        render(movies);
    }
}


function search() {
            const q = document.getElementById('searchInput').value.toLowerCase();
            render(movies.filter(m => m.title.toLowerCase().includes(q)));
        }

function render(data) {
    const grid = document.getElementById('movieGrid');
    if (!grid) return;

    grid.innerHTML = data.map(m => {
        // Check karein ki movie watchlist mein hai ya nahi
        const isSaved = myWatchlist.includes(m.title);

        return `
            <div class="movie-card">
                <img src="${m.img}" alt="${m.title}">
                
                <div class="movie-overlay">
                    <button class="opt-btn play-btn" onclick="openTheater('${m.title}')">▶ PLAY</button>
                    
                    <button class="opt-btn watch-btn" onclick="toggleWatchlist('${m.title}')">
                        ${isSaved ? '✓ SAVED' : '+ WATCHLIST'}
                    </button>
                </div>

               

                <div style="position:absolute; top:10px; right:10px; background:rgba(0,0,0,0.7); padding:2px 8px; border-radius:4px; font-size:10px; color:var(--gold);">
                    ${m.cat}
                </div>
            </div>
        `;
    }).join('');
}



        function filter(c) {
            document.getElementById('catTitle').innerText = c.toUpperCase();
            render(movies.filter(m => m.cat === c));
            showPanel('home');
        }

        function openTheater(t) {
            document.getElementById('mTitle').innerText = t;
            document.getElementById('theater').style.display = 'flex';
        }

        function closeTheater() { document.getElementById('theater').style.display = 'none'; document.getElementById('vid').pause(); }

        function showPanel(p) {
            document.querySelectorAll('.panel').forEach(el => el.classList.remove('active-panel'));
            document.getElementById(p + 'Panel').classList.add('active-panel');
            document.getElementById('heroBanner').style.display = (p === 'home') ? 'flex' : 'none';
            toggleMenu(false);
        }

function showWatchlist() {
    // 1. Filter the main movies list based on titles stored in myWatchlist
    const savedMovies = movies.filter(m => myWatchlist.includes(m.title));
    
    // 2. Change the Title on the page
    document.getElementById('catTitle').innerText = "MY WATCHLIST";
    
    // 3. Show the Home panel where the grid is
    showPanel('home');
    
    // 4. Render only the saved movies
    if (savedMovies.length === 0) {
        document.getElementById('movieGrid').innerHTML = `
            <div style="grid-column: 1/-1; text-align: center; padding: 50px; color: #666;">
                <h3>Your watchlist is empty</h3>
                <p>Click + WATCHLIST on any movie to save it here.</p>
            </div>`;
    } else {
        render(savedMovies);
    }
}

window.addEventListener('click', function(e) {
    const sidebar = document.getElementById('sidebar');
    const menuBtn = document.querySelector('nav div'); // The Menu button
    
    if (sidebar.classList.contains('open') && !sidebar.contains(e.target) && e.target !== menuBtn) {
        toggleMenu(false);
    }
});


function toggleWatchlist(title) {
    const index = myWatchlist.indexOf(title);
    if (index === -1) {
        myWatchlist.push(title);
    } else {
        myWatchlist.splice(index, 1);
    }
    localStorage.setItem('watchlist', JSON.stringify(myWatchlist));

    // If we are currently looking at the Watchlist, refresh with filtered results
    if (document.getElementById('catTitle').innerText === "MY WATCHLIST") {
        showWatchlist();
    } else {
        render(movies); // Otherwise just refresh the normal grid
    }
}
function showAllMovies() {
    // 1. Change the heading back to DISCOVERY
    const titleEl = document.getElementById('catTitle');
    if (titleEl) titleEl.innerText = "DISCOVERY";

    // 2. Make sure we are on the home panel
    showPanel('home');

    // 3. Render the full array
    render(movies);
    
    // 4. Close the menu
    toggleMenu(false);
}


        function toggleMenu(open = null) {
            const s = document.getElementById('sidebar');
            if(open === false) s.classList.remove('open');
            else s.classList.toggle('open');
        }
function logout(){
    localStorage.clear();
    location.reload();
}
        init();
</script>

</body>
    </html>
