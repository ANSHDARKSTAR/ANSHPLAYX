<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CineLux | Premium Streaming</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;800&display=swap" rel="stylesheet">
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <style>
        :root { --gold:#D4AF37; --bg:#050505; --glass:rgba(255,255,255,.05); --border:rgba(255,255,255,.12); }
        * { margin:0; padding:0; box-sizing:border-box; font-family:'Plus Jakarta Sans',sans-serif; }
        body { background:var(--bg); color:#fff; overflow-x: hidden; }
        
        /* NAVIGATION */
        nav { display: grid; grid-template-columns: 1fr 2fr 1fr; align-items: center; padding: 0 5%; height: 90px; position: fixed; width: 100%; z-index: 2000; background: linear-gradient(to bottom, rgba(5,5,5,0.9), transparent); backdrop-filter: blur(15px); }
        .search-box { background: var(--glass); border: 1px solid var(--border); padding: 10px 20px; border-radius: 100px; display: flex; align-items: center; }
        .search-box input { background: transparent; border: none; color: white; outline: none; width: 100%; margin-left: 10px; }

        /* SIDEBAR */
        .sidebar { position: fixed; left: -400px; top: 0; width: 320px; height: 100vh; background: #000; z-index: 4000; padding: 60px 40px; transition: 0.5s; border-right: 1px solid var(--border); }
        .sidebar.open { left: 0; }
        .side-link { display: block; font-size: 18px; padding: 10px 0; color: #ccc; cursor: pointer; transition: 0.3s; text-decoration: none; }
        .side-link:hover { color: var(--gold); transform: translateX(5px); }

        /* HERO */
        .hero { height: 80vh; padding: 0 8%; display: flex; align-items: center; background: linear-gradient(to right, #050505 30%, transparent), url('https://images.unsplash.com/photo-1626814026160-2237a95fc5a0?w=1600') center/cover; }
        
        /* GRID & CARDS */
        .container { padding: 40px 8%; }
        .panel { display: none; animation: fadeIn 0.4s ease; padding: 100px 8% 40px; }
        .active-panel { display: block; }
        .movie-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 25px; }
        .movie-card { border-radius: 15px; overflow: hidden; height: 320px; cursor: pointer; border: 1px solid var(--border); position: relative; transition: 0.4s; background: #111; }
        .movie-card:hover { transform: scale(1.05); border-color: var(--gold); }
        .movie-card img { width: 100%; height: 100%; object-fit: cover; }
        
        .movie-overlay { position: absolute; inset: 0; background: rgba(0, 0, 0, 0.8); display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 10px; opacity: 0; transition: 0.3s; z-index: 2; }
        .movie-card:hover .movie-overlay { opacity: 1; }
        .movie-info { position: absolute; bottom: 0; width: 100%; background: linear-gradient(transparent, rgba(0,0,0,0.9)); padding: 15px; }

        /* BUTTONS */
        .opt-btn { width: 80%; padding: 10px; border: none; border-radius: 5px; font-weight: 800; cursor: pointer; transition: 0.2s; }
        .play-btn { background: var(--gold); color: black; }
        .watch-btn { background: rgba(255, 255, 255, 0.2); color: white; backdrop-filter: blur(5px); border: 1px solid rgba(255, 255, 255, 0.3); }
        .btn-gold { background: var(--gold); border: none; width: 100%; padding: 15px; border-radius: 10px; font-weight: 800; cursor: pointer; color: #000; }
        .card { background: #111; padding: 30px; border-radius: 20px; border: 1px solid var(--border); margin-bottom: 20px; }
        .input-f { width: 100%; padding: 15px; background: #000; border: 1px solid #333; color: white; border-radius: 10px; margin-bottom: 15px; }

        /* VIDEO PLAYER */
        #theater { position: fixed; inset: 0; background: #000; z-index: 9000; display: none; flex-direction: column; }
        video { width: 100%; height: 85vh; background: #000; }

        /* AUTH */
        #authOverlay { position:fixed; inset:0; background:#050505; display:flex; align-items:center; justify-content:center; z-index:9999; text-align:center; }
        
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

    <div id="authOverlay">
        <div>
            <h1 style="font-size:3.5rem; margin-bottom: 20px;">CINE<span style="color:var(--gold)">LUX</span></h1>
            <div id="g_id_onload" data-client_id="739537461326-r2gspogeoruch5a4b2m6kui2v9e1lchp.apps.googleusercontent.com" data-callback="onGoogleLogin" data-auto_prompt="false"></div>
            <div class="g_id_signin" data-type="standard" data-size="large" data-theme="outline" data-shape="pill"></div>
        </div>
    </div>

    <div id="theater">
        <div style="padding: 15px 5%; display: flex; justify-content: space-between; align-items: center; background: #111;">
            <h2 id="mTitle">Now Playing</h2>
            <button onclick="closeTheater()" style="color:var(--gold); background:none; border:none; cursor:pointer; font-weight:800; font-size: 1.2rem;">CLOSE ✕</button>
        </div>
        <video id="vid" controls><source src="https://www.w3schools.com/html/mov_bbb.mp4" type="video/mp4"></video>
    </div>

    <nav>
        <div onclick="toggleMenu(true)" style="color:var(--gold); cursor:pointer; font-weight:800;">☰ MENU</div>
        <div class="search-box">
            <input type="text" id="searchInput" placeholder="Search Movies..." onkeyup="searchMovies()">
        </div>
        <div onclick="showPanel('account')" id="uIcon" style="width:35px; height:35px; border-radius:50%; background:var(--gold); color:black; display:flex; align-items:center; justify-content:center; font-weight:800; cursor:pointer; overflow:hidden;">?</div>
    </nav>

    <div class="sidebar" id="sidebar">
        <div class="side-link" onclick="showAllMovies()">Discovery</div>
        <div class="side-link" onclick="showWatchlist()">My Watchlist</div>
        <hr style="border:0; border-top:1px solid #222; margin:10px 0;">
        <span style="font-size:10px; color:#444; letter-spacing:2px;">CATEGORIES</span>
        <div class="side-link" onclick="filterGenre('Action')">Action</div>
        <div class="side-link" onclick="filterGenre('Sci-Fi')">Sci-Fi</div>
        <div class="side-link" onclick="filterGenre('Drama')">Drama</div>
        <hr style="border:0; border-top:1px solid #222; margin:10px 0;">
        <div class="side-link" onclick="showPanel('account')">Account Details</div>
        <div class="side-link" onclick="showPanel('settings')">Settings</div>
        <div class="side-link" onclick="showPanel('contact')">Contact Support</div>
        <div class="side-link" style="color:#ff4444" onclick="logout()">Logout</div>
    </div>

    <section class="hero" id="heroBanner">
        <div>
            <p style="color:var(--gold); font-weight:800; letter-spacing:4px;">NEW RELEASE</p>
            <h1 style="font-size: 4.5rem; line-height:1; margin: 15px 0;">INTERSTELLAR</h1>
            <button class="btn-gold" style="width:auto; padding: 15px 40px;" onclick="openTheater('Interstellar')">STREAM NOW</button>
        </div>
    </section>

    <div id="homePanel" class="panel active-panel">
        <h2 id="catTitle" style="margin-bottom:30px; font-weight:300; letter-spacing:2px;">DISCOVERY</h2>
        <div class="movie-grid" id="movieGrid"></div>
    </div>

    <div id="accountPanel" class="panel">
        <h1 style="margin-bottom: 20px;">Account Hub</h1>
        <div style="display: flex; gap: 10px; margin-bottom: 20px; overflow-x: auto; padding-bottom: 10px;">
            <button class="btn-gold" style="width:auto; padding:8px 20px; font-size:12px;" onclick="showSubTab('acc-main')">Profile</button>
            <button class="btn-gold" style="width:auto; padding:8px 20px; font-size:12px; background:#222; color:#fff;" onclick="showSubTab('acc-history')">History</button>
            <button class="btn-gold" style="width:auto; padding:8px 20px; font-size:12px; background:#222; color:#fff;" onclick="showSubTab('acc-social')">Likes</button>
        </div>

        <div id="acc-main" class="sub-panel">
            <div class="card">
                <div style="display: flex; align-items: center; gap: 20px; margin-bottom: 30px;">
                    <div id="uAvatar" style="width: 80px; height: 80px; border-radius: 15px; background: var(--gold); display:flex; align-items:center; justify-content:center; overflow:hidden; color:black; font-size:2rem;">?</div>
                    <div>
                        <h2 id="uNameDisplay" style="margin:0">User</h2>
                        <p id="uEmail" style="color: #666; font-size: 14px;"></p>
                    </div>
                </div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div class="info-group"><label style="font-size:10px; color:#666;">PLAN</label><p style="color:var(--gold)">Lifetime Pro</p></div>
                    <div class="info-group"><label style="font-size:10px; color:#666;">STATUS</label><p>Active ✓</p></div>
                </div>
            </div>
        </div>

        <div id="acc-history" class="sub-panel" style="display:none;">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
                <h3>Watch History</h3>
                <button onclick="clearHistory()" style="background:none; border:none; color:#ff4444; cursor:pointer;">Clear All</button>
            </div>
            <div id="historyList" style="display: flex; flex-direction: column; gap: 10px;"></div>
        </div>

        <div id="acc-social" class="sub-panel" style="display:none;">
            <h3 style="margin-bottom:15px;">My Likes</h3>
            <div id="likesList" style="display:grid; grid-template-columns:1fr 1fr; gap:10px;"></div>
        </div>
    </div>

    <div id="settingsPanel" class="panel">
        <h1>Settings</h1>
        <div class="card">
            <h3 style="color:var(--gold); margin-bottom:15px;">Languages</h3>
            <select class="input-f">
                <option>English</option>
                <option>Hindi</option>
                <option>Spanish</option>
            </select>
            <button class="btn-gold" onclick="checkUpdates(this)">Check for Updates</button>
            <div id="settingsFooter" style="margin-top:40px; border-top:1px solid #222; padding-top:20px; text-align:center; color:#444; font-size:11px;"></div>
        </div>
    </div>

    <div id="contactPanel" class="panel">
        <h1>Contact Support</h1>
        <div class="card">
            <input type="text" class="input-f" placeholder="Subject">
            <textarea class="input-f" placeholder="How can we help?" style="height:150px;"></textarea>
            <button class="btn-gold" onclick="alert('Support Message Sent!')">Send Message</button>
        </div>
    </div>

    <script>
        // DATA
        const movies = [
            { title: "Inception", rating: "8.8", cat: "Sci-Fi", img: "https://images.unsplash.com/photo-1440404653325-ab127d49abc1?auto=format&fit=crop&w=400&q=80" },
            { title: "The Dark Knight", rating: "9.0", cat: "Action", img: "https://images.unsplash.com/photo-1478720568477-152d9b164e26?auto=format&fit=crop&w=400&q=80" },
            { title: "Avatar: Way of Water", rating: "7.8", cat: "Sci-Fi", img: "https://images.unsplash.com/photo-1536440136628-849c177e76a1?auto=format&fit=crop&w=400&q=80" },
            { title: "Interstellar", rating: "8.7", cat: "Sci-Fi", img: "https://images.unsplash.com/photo-1626814026160-2237a95fc5a0?auto=format&fit=crop&w=400&q=80" },
            { title: "Joker", rating: "8.4", cat: "Drama", img: "https://images.unsplash.com/photo-1509248961158-e54f6934749c?auto=format&fit=crop&w=400&q=80" },
            { title: "The Martian", rating: "8.0", cat: "Sci-Fi", img: "https://images.unsplash.com/photo-1614728263952-84ea256f9679?auto=format&fit=crop&w=400&q=80" }
        ];

        let myWatchlist = JSON.parse(localStorage.getItem('watchlist')) || [];
        let watchHistory = JSON.parse(localStorage.getItem('watchHistory')) || [];
        let likedMovies = JSON.parse(localStorage.getItem('likedMovies')) || [];

        // INITIALIZE
        function init() {
            const u = JSON.parse(localStorage.getItem('user'));
            if (!u) {
                document.getElementById('authOverlay').style.display = 'flex';
                return;
            }
            document.getElementById('authOverlay').style.display = 'none';
            
            // Setup User UI
            const userIcon = document.getElementById('uIcon');
            const uAvatar = document.getElementById('uAvatar');
            if(u.picture) {
                const img = `<img src="${u.picture}" style="width:100%;height:100%;object-fit:cover;">`;
                userIcon.innerHTML = img;
                uAvatar.innerHTML = img;
            }
            document.getElementById('uNameDisplay').innerText = u.name;
            document.getElementById('uEmail').innerText = u.email;

            updateDeviceInfo();
            renderMovies(movies);
        }

        function onGoogleLogin(res) {
            const payload = JSON.parse(atob(res.credential.split('.')[1]));
            localStorage.setItem('user', JSON.stringify(payload));
            location.reload();
        }

        // CORE RENDERING
        function renderMovies(data) {
            const grid = document.getElementById('movieGrid');
            grid.innerHTML = data.map(m => {
                const isSaved = myWatchlist.includes(m.title);
                const isLiked = likedMovies.includes(m.title);
                return `
                    <div class="movie-card">
                        <img src="${m.img}" alt="${m.title}">
                        <div class="movie-overlay">
                            <button class="opt-btn play-btn" onclick="openTheater('${m.title}')">▶ PLAY</button>
                            <button class="opt-btn watch-btn" onclick="toggleWatchlist('${m.title}')">${isSaved ? '✓ SAVED' : '+ WATCHLIST'}</button>
                            <button onclick="toggleLike('${m.title}')" style="background:none; border:none; color:${isLiked ? '#ff4444' : '#fff'}; cursor:pointer; font-size:1.5rem;">${isLiked ? '❤' : '♡'}</button>
                        </div>
                        <div class="movie-info">
                            <h3 style="font-size: 0.9rem; margin: 0;">${m.title}</h3>
                            <div style="display:flex; justify-content:space-between; font-size:0.7rem;">
                                <span style="color:var(--gold)">★ ${m.rating}</span>
                                <span style="opacity:0.6">${m.cat}</span>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // NAVIGATION & PANELS
        function showPanel(p) {
            document.querySelectorAll('.panel').forEach(el => el.classList.remove('active-panel'));
            document.getElementById(p + 'Panel').classList.add('active-panel');
            document.getElementById('heroBanner').style.display = (p === 'home') ? 'flex' : 'none';
            toggleMenu(false);
            window.scrollTo(0,0);
        }

        function toggleMenu(open) {
            const s = document.getElementById('sidebar');
            if(open === true) s.classList.add('open');
            else s.classList.remove('open');
        }

        // SEARCH & FILTER
        function searchMovies() {
            const q = document.getElementById('searchInput').value.toLowerCase();
            const filtered = movies.filter(m => m.title.toLowerCase().includes(q));
            renderMovies(filtered);
        }

        function filterGenre(genre) {
            document.getElementById('catTitle').innerText = genre.toUpperCase();
            const filtered = movies.filter(m => m.cat === genre);
            renderMovies(filtered);
            showPanel('home');
        }

        function showAllMovies() {
            document.getElementById('catTitle').innerText = "DISCOVERY";
            renderMovies(movies);
            showPanel('home');
        }

        // WATCHLIST
        function toggleWatchlist(title) {
            const idx = myWatchlist.indexOf(title);
            if(idx === -1) myWatchlist.push(title);
            else myWatchlist.splice(idx, 1);
            localStorage.setItem('watchlist', JSON.stringify(myWatchlist));
            
            if(document.getElementById('catTitle').innerText === "MY WATCHLIST") showWatchlist();
            else searchMovies(); // Refresh current view
        }

        function showWatchlist() {
            document.getElementById('catTitle').innerText = "MY WATCHLIST";
            const filtered = movies.filter(m => myWatchlist.includes(m.title));
            renderMovies(filtered);
            showPanel('home');
        }

        // LIKES
        function toggleLike(title) {
            const idx = likedMovies.indexOf(title);
            if(idx === -1) likedMovies.push(title);
            else likedMovies.splice(idx, 1);
            localStorage.setItem('likedMovies', JSON.stringify(likedMovies));
            searchMovies();
            if(document.getElementById('acc-social').style.display !== 'none') renderLikesList();
        }

        // THEATER & HISTORY
        function openTheater(title) {
            document.getElementById('mTitle').innerText = title;
            document.getElementById('theater').style.display = 'flex';
            addToHistory(title);
        }

        function closeTheater() {
            document.getElementById('theater').style.display = 'none';
            document.getElementById('vid').pause();
        }

        function addToHistory(title) {
            watchHistory = watchHistory.filter(t => t !== title);
            watchHistory.unshift(title);
            if(watchHistory.length > 15) watchHistory.pop();
            localStorage.setItem('watchHistory', JSON.stringify(watchHistory));
        }

        function clearHistory() {
            watchHistory = [];
            localStorage.removeItem('watchHistory');
            renderHistoryList();
        }

        // ACCOUNT SUB-TABS
        function showSubTab(tabId) {
            document.querySelectorAll('.sub-panel').forEach(p => p.style.display = 'none');
            document.getElementById(tabId).style.display = 'block';
            if(tabId === 'acc-history') renderHistoryList();
            if(tabId === 'acc-social') renderLikesList();
        }

        function renderHistoryList() {
            const container = document.getElementById('historyList');
            container.innerHTML = watchHistory.length ? watchHistory.map(t => `
                <div class="card" style="padding:15px; display:flex; justify-content:space-between; align-items:center; background:rgba(255,255,255,0.03);">
                    <span>${t}</span>
                    <button class="btn-gold" style="width:auto; padding:5px 15px; font-size:10px;" onclick="openTheater('${t}')">REWATCH</button>
                </div>
            `).join('') : "<p style='color:#444'>No history yet.</p>";
        }

        function renderLikesList() {
            const container = document.getElementById('likesList');
            container.innerHTML = likedMovies.length ? likedMovies.map(t => `
                <div class="card" style="padding:15px; text-align:center; border-color:var(--gold);">${t}</div>
            `).join('') : "<p style='color:#444'>No likes yet.</p>";
        }

        // SYSTEM
        function updateDeviceInfo() {
            const footer = document.getElementById('settingsFooter');
            footer.innerHTML = `DEVICE: <b>${navigator.platform}</b> | ENGINE: <b>V8-CineLux</b><br>SESSION: <b>ACTIVE</b>`;
        }

        function checkUpdates(btn) {
            btn.innerText = "Checking...";
            setTimeout(() => {
                btn.innerText = "v2.4.0 (Up to Date) ✓";
                alert("System Log: All modules optimized. History and Watchlist sync active.");
            }, 1000);
        }

        function logout() { localStorage.clear(); location.reload(); }

        // Close sidebar on outside click
        window.onclick = function(e) {
            const s = document.getElementById('sidebar');
            if(s.classList.contains('open') && !s.contains(e.target) && !e.target.innerText.includes('MENU')) toggleMenu(false);
        }

        init();
    </script>
</body>
</html>
