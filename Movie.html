<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CineLux</title>

<link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;800&display=swap" rel="stylesheet">
<script src="https://accounts.google.com/gsi/client" async defer></script>

<style>
:root {
    --gold:#D4AF37;
    --bg:#050505;
    --glass:rgba(255,255,255,.05);
    --border:rgba(255,255,255,.12);
}
*{margin:0;padding:0;box-sizing:border-box;font-family:'Plus Jakarta Sans',sans-serif;}
body{background:var(--bg);color:#fff}

/* Container for the buttons */
.movie-overlay {
    position: absolute;
    inset: 0;
    background: rgba(0, 0, 0, 0.7);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 10px;
    opacity: 0; /* Hidden by default */
    transition: 0.3s ease;
    z-index: 2;
}

/* Show overlay on hover */
.movie-card:hover .movie-overlay {
    opacity: 1;
}

/* Button Styles */
.opt-btn {
    width: 80%;
    padding: 10px;
    border: none;
    border-radius: 5px;
    font-weight: 800;
    cursor: pointer;
    transition: 0.2s;
}

.play-btn {
    background: var(--gold);
    color: black;
}

.watch-btn {
    background: rgba(255, 255, 255, 0.2);
    color: white;
    backdrop-filter: blur(5px);
    border: 1px solid rgba(255, 255, 255, 0.3);
}

.opt-btn:hover {
    transform: scale(1.05);
}

/* AUTH */
#authOverlay{
    position:fixed;inset:0;
    background:#050505;
    display:flex;align-items:center;justify-content:center;
    z-index:9999;text-align:center;
}
/* --- NAVIGATION --- */
        nav {
            display: grid; grid-template-columns: 1fr 2fr 1fr; align-items: center;
            padding: 0 5%; height: 90px; position: fixed; width: 100%; z-index: 2000;
            background: linear-gradient(to bottom, rgba(5,5,5,0.9), transparent); backdrop-filter: blur(15px);
        }
        .search-box { background: var(--glass); border: 1px solid var(--border); padding: 10px 20px; border-radius: 100px; display: flex; align-items: center; }
        .search-box input { background: transparent; border: none; color: white; outline: none; width: 100%; margin-left: 10px; }

        /* --- HERO BANNER --- */
        .hero {
            height: 80vh; padding: 0 8%; display: flex; align-items: center;
            background: linear-gradient(to right, #050505 30%, transparent), url('https://images.unsplash.com/photo-1626814026160-2237a95fc5a0?w=1600') center/cover;
        }

        /* --- SIDEBAR --- */
        .sidebar { position: fixed; left: -400px; top: 0; width: 320px; height: 100vh; background: #000; z-index: 4000; padding: 60px 40px; transition: 0.5s; border-right: 1px solid var(--border); }
        .sidebar.open { left: 0; }
        .side-link { display: block; font-size: 18px; padding: 10px 0; color: #ccc; cursor: pointer; transition: 0.3s; }
        .side-link:hover { color: var(--gold); transform: translateX(5px); }

        /* --- CONTENT --- */
        .container { padding: 40px 8%; }
        .panel { display: none; animation: fadeIn 0.4s ease; }
        .active-panel { display: block; }
        .movie-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 20px; }
        .movie-card { border-radius: 15px; overflow: hidden; height: 320px; cursor: pointer; border: 1px solid var(--border); position: relative; transition: 0.4s; }
        .movie-card:hover { transform: scale(1.05); border-color: var(--gold); }
        .movie-card img { width: 100%; height: 100%; object-fit: cover; }

        /* --- INPUTS --- */
        .card { background: #111; padding: 30px; border-radius: 20px; border: 1px solid var(--border); }
        .input-f { width: 100%; padding: 15px; background: #000; border: 1px solid #333; color: white; border-radius: 10px; margin-bottom: 15px; }
        .btn-gold { background: var(--gold); border: none; width: 100%; padding: 15px; border-radius: 10px; font-weight: 800; cursor: pointer; }

.movie-info {
    position: absolute;
    bottom: 0;
    width: 100%;
    background: linear-gradient(transparent, rgba(0,0,0,0.9));
    padding: 20px 15px !important;
}


        /* --- VIDEO PLAYER --- */
        #theater { position: fixed; inset: 0; background: #000; z-index: 9000; display: none; flex-direction: column; }
        video { width: 100%; height: 90vh; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
</style>
</head>

<body>

<!-- AUTH -->
<div id="authOverlay">
    <div>
        <h1 style="font-size:3.5rem">
            CINE<span style="color:var(--gold)">LUX</span>
        </h1>

        <!-- GOOGLE LOGIN -->
        <div id="g_id_onload"
             data-client_id="739537461326-r2gspogeoruch5a4b2m6kui2v9e1lchp.apps.googleusercontent.com"
             data-callback="onGoogleLogin"
             data-auto_prompt="false">
        </div>

        <div class="g_id_signin"
             data-type="standard"
             data-size="large"
             data-theme="outline"
             data-shape="pill"
             data-text="continue_with">
        </div>
    </div>
</div>

<!-- VIDEO PLAYER -->

    <div id="theater">
        <div style="padding: 15px 5%; display: flex; justify-content: space-between;">
            <h2 id="mTitle">Now Playing</h2>
            <button onclick="closeTheater()" style="color:var(--gold); background:none; border:none; cursor:pointer; font-weight:800;">CLOSE ✕</button>
        </div>
        <video id="vid" controls autoplay><source src="https://www.w3schools.com/html/mov_bbb.mp4" type="video/mp4"></video>
    </div>

    <nav>
        <div onclick="toggleMenu()" style="color:var(--gold); cursor:pointer; font-weight:800;">☰ MENU</div>
        <div class="search-box">
            <input type="text" id="searchInput" placeholder="Search Movies..." onkeyup="search()">
        </div>
        <div onclick="showPanel('account')" id="uIcon" style="width:35px; height:35px; border-radius:50%; background:var(--gold); color:black; display:flex; align-items:center; justify-content:center; font-weight:800; cursor:pointer; justify-self: end;">?</div>
    </nav>

    <div class="sidebar" id="sidebar">
        <div class="side-link" onclick="showPanel('home')">Discovery</div>
        <hr style="border:0; border-top:1px solid #222; margin:10px 0;">
        <span style="font-size:10px; color:#444; letter-spacing:2px;">CATEGORIES</span>
        <div class="side-link" onclick="filter('Action')">Action</div>
        <div class="side-link" onclick="filter('Sci-Fi')">Sci-Fi</div>
        <div class="side-link" onclick="filter('Horror')">Horror</div>
        <div class="side-link" onclick="filter('Drama')">Drama</div>
        <div class="side-link" onclick="filter('Documentary')">Documentary</div>
        <hr style="border:0; border-top:1px solid #222; margin:10px 0;">
        <div class="side-link" onclick="showPanel('account')">Account Details</div>
        <div class="side-link" onclick="showPanel('settings')">Settings</div>
        <div class="side-link" onclick="showPanel('contact')">Contact Support</div>
        <div class="side-link" style="color:#ff4444" onclick="logout()">Logout</div>
    </div>

    <section class="hero" id="heroBanner">
        <div>
            <p style="color:var(--gold); font-weight:800; letter-spacing:4px;">NEW RELEASE</p>
            <h1 style="font-size: 4.5rem; line-height:1; margin: 15px 0;">INTERSTELLAR</h1>
            <button class="btn-gold" style="width:auto; padding: 15px 40px;" onclick="openTheater('Interstellar')">STREAM NOW</button>
        </div>
    </section>

    <div class="container">
        <div id="homePanel" class="panel active-panel">
            <div class="movie-grid" id="movieGrid"></div>
        </div>

        <div id="accountPanel" class="panel">
            <h1>Account</h1>
            <div class="card">
                <p>Email: <span id="uEmail"></span></p>
                <p style="margin-top:10px;">Membership: <span style="color:var(--gold)">CineLux Pro</span></p>
            </div>
        </div>

        <div id="settingsPanel" class="panel">
            <h1>Settings</h1>
            <div class="card">
                <p>Auto-play next episode: <input type="checkbox" checked></p>
                <p style="margin-top:20px;">Streaming Quality: 4K Ultra HD</p>
            </div>
        </div>

        <div id="contactPanel" class="panel">
            <h1>Contact Support</h1>
            <div class="card">
                <input type="text" class="input-f" placeholder="Subject">
                <textarea class="input-f" placeholder="How can we help?" style="height:150px;"></textarea>
                <button class="btn-gold" onclick="alert('Support Message Sent!')">Send Message</button>
            </div>
        </div>
    </div>

    <script>
        const movies = [
            { title: "Inception", rating: "8.8", img: "https://images.unsplash.com/photo-1440404653325-ab127d49abc1?auto=format&fit=crop&w=400&q=80" },
            { title: "The Dark Knight", rating: "9.0", img: "https://images.unsplash.com/photo-1478720568477-152d9b164e26?auto=format&fit=crop&w=400&q=80" },
            { title: "Avatar: Way of Water", rating: "7.8", img: "https://images.unsplash.com/photo-1536440136628-849c177e76a1?auto=format&fit=crop&w=400&q=80" },
            { title: "The Matrix", rating: "8.7", img: "https://images.unsplash.com/photo-1626814026160-2237a95fc5a0?auto=format&fit=crop&w=400&q=80" },
            { title: "Joker", rating: "8.4", img: "https://images.unsplash.com/photo-1509248961158-e54f6934749c?auto=format&fit=crop&w=400&q=80" },
            { title: "The Martian", rating: "8.0", img: "https://images.unsplash.com/photo-1614728263952-84ea256f9679?auto=format&fit=crop&w=400&q=80" }
        ];

function onGoogleLogin(res){
    const payload = JSON.parse(atob(res.credential.split('.')[1]));
    localStorage.setItem('user',JSON.stringify(payload));
    location.reload();
}

function init() {
    const u = JSON.parse(localStorage.getItem('user'));
    
    // 1. If no user is logged in, show the Auth Overlay and STOP.
    if (!u) {
        document.getElementById('authOverlay').style.display = 'flex';
        // Note: We don't call render(movies) here because the user is locked out.
        // If you want to see movies WITHOUT logging in, comment out the "if(!u) return" line.
        return; 
    }

    // 2. If user exists, hide login screen
    document.getElementById('authOverlay').style.display = 'none';

    // 3. Update User UI (Fixed the 'avatar' error)
    const userIcon = document.getElementById('uIcon');
    if(u.picture) {
        userIcon.innerHTML = `<img src="${u.picture}" style="width:100%; border-radius:50%">`;
    } else {
        userIcon.innerText = u.name ? u.name[0] : '?';
    }
    
    document.getElementById('uEmail').innerText = u.email;

    // 4. FINALLY render the movies
    render(movies);
}

function render(data) {
    const grid = document.getElementById('movieGrid');
    if (!grid) return; // Safety check

    if (data.length === 0) {
        grid.innerHTML = "<p style='color:#666;'>No movies found in this category.</p>";
        return;
    }

    grid.innerHTML = data.map(m => `
        <div class="movie-card" onclick="openTheater('${m.title}')">
            <img src="${m.img}" alt="${m.title}">
                                    <div class="movie-info">
                            <h3>${movie.title}</h3>
                            <span class="rating">★ ${movie.rating}</span>
                        </div>
            <div style="position:absolute; bottom:10px; left:10px; background:rgba(0,0,0,0.7); padding:2px 8px; border-radius:4px; font-size:10px; color:var(--gold);">
                ${m.cat}
            </div>
        </div>
    `).join('');
}


function render(data) {
            document.getElementById('movieGrid').innerHTML = data.map(m => `
                <div class="movie-card" onclick="openTheater('${m.title}')">
                    <img src="${m.img}">
                </div>
            `).join('');
        }

function search() {
            const q = document.getElementById('searchInput').value.toLowerCase();
            render(movies.filter(m => m.title.toLowerCase().includes(q)));
        }

function render(data) {
    const grid = document.getElementById('movieGrid');
    if (!grid) return;

    grid.innerHTML = data.map(m => `
        <div class="movie-card">
            <img src="${m.img}" alt="${m.title}">
            
            <div class="movie-overlay">
                <button class="opt-btn play-btn" onclick="openTheater('${m.title}')">▶ PLAY</button>
                <button class="opt-btn watch-btn" onclick="addToWatchlist('${m.title}')">+ WATCHLIST</button>
            </div>

            <div class="movie-info" style="position: absolute; bottom: 0; width: 100%; background: linear-gradient(transparent, rgba(0,0,0,0.9)); padding: 15px;">
                <h3 style="font-size: 1rem; margin: 0;">${m.title}</h3>
                <span style="color: var(--gold); font-size: 0.8rem;">★ ${m.rating || '8.5'}</span>
            </div>

            <div style="position:absolute; top:10px; right:10px; background:rgba(0,0,0,0.7); padding:2px 8px; border-radius:4px; font-size:10px; color:var(--gold);">
                ${m.cat}
            </div>
        </div>
    `).join('');
}

// Add this function to handle the watchlist alert
function addToWatchlist(title) {
    alert(title + " added to your watchlist!");
}


        function filter(c) {
            document.getElementById('catTitle').innerText = c.toUpperCase();
            render(movies.filter(m => m.cat === c));
            showPanel('home');
        }

        function openTheater(t) {
            document.getElementById('mTitle').innerText = t;
            document.getElementById('theater').style.display = 'flex';
        }

        function closeTheater() { document.getElementById('theater').style.display = 'none'; document.getElementById('vid').pause(); }

        function showPanel(p) {
            document.querySelectorAll('.panel').forEach(el => el.classList.remove('active-panel'));
            document.getElementById(p + 'Panel').classList.add('active-panel');
            document.getElementById('heroBanner').style.display = (p === 'home') ? 'flex' : 'none';
            toggleMenu(false);
        }

        function toggleMenu(open = null) {
            const s = document.getElementById('sidebar');
            if(open === false) s.classList.remove('open');
            else s.classList.toggle('open');
        }
function logout(){
    localStorage.clear();
    location.reload();
}
        init();
</script>

</body>
    </html>
